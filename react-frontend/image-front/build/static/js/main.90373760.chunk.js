(this["webpackJsonpimage-front"]=this["webpackJsonpimage-front"]||[]).push([[0],{60:function(e,t,a){},61:function(e,t,a){},65:function(e,t,a){},87:function(e,t,a){},91:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),i=a(22),c=a.n(i),r=(a(60),a(61),a(23)),l=a(35),o=a.n(l),d=a(49),h=a(25),m=a(26),g=a(30),j=a(28),u=a(55),p=(a(65),a(96)),b=a(94),x=a(99),f=a(95),y=a(15),O=a.n(y),v=a(36);a(84);function I(){return O.a.get("/api/get_req_url/").then((function(e){return e.data.req_url})).catch((function(e){console.log(e)}))}var z=a(2),w=function(e){Object(g.a)(a,e);var t=Object(j.a)(a);function a(e){var n;return Object(h.a)(this,a),(n=t.call(this,e)).handleResize=function(){var e=n.dropzoneRef.current.getBoundingClientRect(),t=e.width,a=e.height;n.setState({dropzoneDimensions:{width:t,height:a}})},n.handleEhrChange=function(e){n.setState({e_hr:e.target.value})},n.handleEminChange=function(e){n.setState({e_min:e.target.value})},n.onDrop=function(e){e.length>1?n.setState({isMultipleimages:!0}):(n.setState({isLoading:!0,files:[],recentImage:null,previewImage:e[0],isMultipleimages:!1}),n.loadingImage(e))},n.loadingImage=function(e){setTimeout((function(){n.setState({files:e,isLoading:!1,showProcessedImage:!1},(function(){console.log(n.state.files[0].name)}))}),1e3)},n.analyzingImage=function(){setTimeout((function(){n.setState({isAnalyzing:!1},(function(){console.log(n.state.files[0].name)}))}),1e3)},n.activateSpinner=function(){n.setState({isLoading:!0,isAnalyzing:!0,files:[]})},n.deactivateSpinner=function(){n.setState({isLoading:!1,isAnalyzing:!1})},n.handleDisabledClick=function(){n.setState({showMessage:!0})},n.sendImage=function(){n.setState({isLoading:!1,isAnalyzing:!0,files:[]});var e=new FormData;e.append("image",n.state.files[0],n.state.files[0].name),e.append("e_hr",n.state.e_hr),e.append("e_min",n.state.e_min),I().then((function(t){O.a.post("".concat(t,"/api/images/"),e,{headers:{accept:"application/json","content-type":"multipart/form-data"}}).then((function(e){n.getImageResults(e),console.log(e.data)})).catch((function(e){console.log("Error Message here: "+e)}))}))},n.getImageResults=function(e){I().then((function(t){O.a.get("".concat(t,"/api/images/").concat(e.data.id,"/"),{headers:{accept:"application/json"}}).then((function(e){n.setState({recentImage:e,analyzedInfo:e.data.analyzed_info}),console.log(e)})).catch((function(e){console.log("Error Message here: "+e)})),n.deactivateSpinner()}))},n.showProcessedImage=Object(d.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I();case 2:t=e.sent,O.a.get("".concat(t).concat(n.state.recentImage.data.processed_image),{headers:{accept:"image/png, image/jpeg"},responseType:"blob"}).then((function(e){n.getImageResults(e),console.log(e.data),n.setState({showProcessedImage:!1})})).catch((function(e){console.log("Error Message here: "+e)})),n.setState({showProcessedImage:!0});case 5:case"end":return e.stop()}}),e)}))),n.hideProcessedImage=function(){n.setState({showProcessedImage:!1})},n.state={files:[],isLoading:!1,isAnalyzing:!1,recentImage:null,previewImage:null,e_hr:"",e_min:"",showMessage:!1,isMultipleimages:!1,showProcessedImage:!1,analyzedInfo:null,dropzoneDimensions:{width:0,height:0}},n.dropzoneRef=s.a.createRef(),n}return Object(m.a)(a,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.handleResize);var e=this.dropzoneRef.current.getBoundingClientRect(),t=e.width,a=e.height;this.setState({dropzoneDimensions:{width:t,height:a}})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize)}},{key:"render",value:function(){var e=this.state.dropzoneDimensions,t={maxWidth:"".concat(.99*e.width,"px"),maxHeight:"".concat(.9*e.height,"px"),objectFit:"contain"},a={display:"flex",justifyContent:"center",alignItems:"center",width:"".concat(e.width,"px"),height:"".concat(e,"px")};this.state.files.map((function(e){return Object(z.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:Object(z.jsxs)("li",{style:{margin:"auto"},children:[e.name," - ",e.size," bytes"]},e.name)})}));return Object(z.jsxs)(s.a.Fragment,{children:[null===this.state.recentImage&&Object(z.jsx)("div",{ref:this.dropzoneRef,style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",minHeight:"250px",border:"2px dashed #ccc"},children:Object(z.jsx)("div",{className:"image-preview",style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:this.state.previewImage?Object(z.jsx)("img",{src:URL.createObjectURL(this.state.previewImage),alt:"",style:t}):Object(z.jsx)(u.a,{onDrop:this.onDrop,accept:"image/png, image/jpeg",children:function(e){var t=e.isDragActive,n=e.getRootProps,s=e.getInputProps;return Object(z.jsxs)("div",Object(r.a)(Object(r.a)({},n({className:"dropzone back"})),{},{style:Object(r.a)(Object(r.a)({},a),{},{display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"}),children:[Object(z.jsx)("input",Object(r.a)({},s())),Object(z.jsx)("i",{className:"fa fa-cloud-upload fa-4x text-muted",style:{fontSize:120}}),Object(z.jsx)("p",{className:"text-muted",children:t?"Drop some images":"Drag 'n' drop some files here, or click to select files"})]}))}})})}),Object(z.jsx)(p.a,{children:this.state.recentImage?null:Object(z.jsx)(s.a.Fragment,{children:Object(z.jsxs)("div",{className:"row justify-content-center",style:{marginTop:"5px"},children:[Object(z.jsx)("label",{htmlFor:"exposure_time",className:"col-form-label",children:"Exposure Time"}),Object(z.jsx)("div",{className:"col-sm-2 col-md-4",children:Object(z.jsx)("input",{type:"number",className:"form-control",placeholder:"",id:"exposure_hour",name:"e_hr",value:this.state.e_hr,onChange:this.handleEhrChange,min:"0",style:{width:"100%"}})}),Object(z.jsx)("label",{htmlFor:"exposure_hour",className:"col-form-label",children:"h"}),Object(z.jsx)("div",{className:"col-sm-2 col-md-4",children:Object(z.jsx)("input",{type:"number",className:"form-control",placeholder:"",id:"exposure_min",name:"e_min",value:this.state.e_min,onChange:this.handleEminChange,min:"0",style:{width:"100%"}})}),Object(z.jsx)("label",{htmlFor:"exposure_min",className:"col-form-label",children:"m"})]})})}),this.state.files.length>0&&(""!==this.state.e_hr&&""!==this.state.e_min&&parseInt(this.state.e_hr)>=0&&parseInt(this.state.e_min)>=0&&(0!==parseInt(this.state.e_hr)||0!==parseInt(this.state.e_min))?Object(z.jsx)(b.a,{variant:"info",size:"lg",className:"mt-3",onClick:this.sendImage,children:"Analyze"}):Object(z.jsx)(b.a,{variant:"info",size:"lg",className:"mt-3",onClick:this.handleDisabledClick,children:"Analyze"})),this.state.showMessage&&(""===this.state.e_hr||""===this.state.e_min)&&Object(z.jsx)(x.a,{variant:"warning",style:{marginTop:"13px"},children:"Please fill in both 'Exposure Hour' and 'Exposure Minute' fields."}),this.state.showMessage&&0===parseInt(this.state.e_hr)&&0===parseInt(this.state.e_min)&&Object(z.jsx)(x.a,{variant:"warning",style:{marginTop:"13px"},children:"At least one of them should be 1 or greater."}),this.state.showMessage&&(parseInt(this.state.e_hr)<0||parseInt(this.state.e_min)<0)&&Object(z.jsx)(x.a,{variant:"warning",style:{marginTop:"13px"},children:"Please enter only non-negative values for 'Exposure Hour' and 'Exposure Minute'."}),this.state.isMultipleimages&&Object(z.jsx)(x.a,{variant:"warning",style:{marginTop:"13px"},children:"Please upload only one image at a time."}),this.state.isLoading&&Object(z.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(z.jsx)(f.a,{animation:"border",role:"status",style:{marginTop:"50px"}}),Object(z.jsx)("div",{style:{textAlign:"center",marginTop:"5px"},children:"Loading..."})]}),this.state.isAnalyzing&&Object(z.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[Object(z.jsx)(f.a,{animation:"border",role:"status",style:{marginTop:"50px"}}),Object(z.jsx)("div",{style:{textAlign:"center",marginTop:"5px"},children:"Analyzing..."})]}),this.state.recentImage&&Object(z.jsxs)(s.a.Fragment,{children:[this.state.recentImage.data.analyzed.includes("Failed")&&Object(z.jsx)(x.a,{variant:"warning",style:{marginTop:"12px"},children:Object(z.jsx)("div",{className:"auto-line-break analyzed-results",children:this.state.recentImage.data.analyzed})}),!this.state.recentImage.data.analyzed.includes("Failed")&&Number(this.state.recentImage.data.analyzed)<=100?Object(z.jsx)(x.a,{variant:"primary",style:{marginTop:"12px"},children:Object(z.jsxs)("div",{className:"auto-line-break analyzed-results",children:["Ozone exposure level",Object(z.jsx)("br",{}),Object(z.jsx)("b",{children:Math.round(this.state.recentImage.data.analyzed)})," ppb"]})}):!this.state.recentImage.data.analyzed.includes("Failed")&&Object(z.jsx)(x.a,{variant:"danger",style:{marginTop:"12px"},children:Object(z.jsxs)("div",{className:"auto-line-break analyzed-results",children:["Ozone exposure level",Object(z.jsx)("br",{})," ",Object(z.jsx)("b",{children:Math.round(this.state.recentImage.data.analyzed)})," ppb"]})}),!this.state.recentImage.data.analyzed.includes("Failed")&&Object(z.jsx)("div",{className:"circular-progress-bar",style:{marginTop:"13px !important"},children:Object(z.jsx)(v.a,{value:Number(this.state.recentImage.data.analyzed),text:Number(this.state.recentImage.data.analyzed)<=100?"SAFE":"DANGER",styles:Object(v.b)({fontSize:"14px",textColor:Number(this.state.recentImage.data.analyzed)<=100?"#007bff":"#dc3545",pathColor:Number(this.state.recentImage.data.analyzed)<=100?"#007bff":"#dc3545",trailColor:"#f2f2f2"})})})]})]})}}]),a}(n.Component),_=function(e){return Object(z.jsx)("div",{className:"image-container",style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:"10px"},children:Object(z.jsx)("div",{style:{border:"2px solid #ccc",borderRadius:"4px",padding:"3px",marginTop:"0px",marginBottom:"3px"},children:Object(z.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[Object(z.jsxs)("b",{style:{color:"gray",fontStyle:"italic"},children:["Processed  Image Data #",e.id]}),Object(z.jsx)("img",{className:"justify-content-center",src:e.pict,height:"300",rounded:!0,align:"center",style:{marginTop:"0px",marginBottom:"7px"}}),Object(z.jsx)("div",{className:"analyzed-info-container",children:e.analyzedInfo&&Object(z.jsx)("div",{className:"analyzed-info auto-line-break",style:{marginBottom:"0px !important"},children:Object(z.jsx)("b",{style:{color:"gray",fontStyle:"italic"},children:Object(z.jsx)("p",{children:e.analyzedInfo})})})})]})})})},N=function(e){Object(g.a)(a,e);var t=Object(j.a)(a);function a(){var e;Object(h.a)(this,a);for(var n=arguments.length,s=new Array(n),i=0;i<n;i++)s[i]=arguments[i];return(e=t.call.apply(t,[this].concat(s))).state={images:[],visible:2,isLoading:!0,newLoaded:!1,status:!1},e.getImages=function(){I().then((function(t){O.a.get("".concat(t,"/api/images/"),{headers:{accept:"application/json"}}).then((function(t){e.setState({images:t.data,analyzedInfo:t.data.analyzed_info,status:!0}),console.log(t)})),e.setState({isLoading:!1})}))},e.handleVisible=function(){var t=e.state.visible+2;e.setState({newLoaded:!0}),setTimeout((function(){e.setState({visible:t,newLoaded:!1})}),300)},e}return Object(m.a)(a,[{key:"componentDidMount",value:function(){setTimeout(this.getImages,1e3)}},{key:"render",value:function(){var e=this.state.images.slice(0,this.state.visible).map((function(e,t){return Object(z.jsx)(_,{pict:e.processed_image,name:e.analyzed,analyzedInfo:e.analyzed_info,id:t+1},e.id)}));return Object(z.jsxs)("div",{children:[Object(z.jsx)("h3",{children:" Analysis of images"}),0===this.state.images.length&&this.state.status&&Object(z.jsx)("h3",{children:"No images Analyzed"}),this.state.isLoading?Object(z.jsx)(f.a,{animation:"border",role:"status"}):Object(z.jsxs)(s.a.Fragment,{children:[e,this.state.newLoaded&&Object(z.jsx)(f.a,{animation:"border",role:"status"}),Object(z.jsx)("br",{}),this.state.images.length>this.state.visible&&this.state.images.length>2&&Object(z.jsx)(b.a,{clasName:"mb-5",variant:"primary",size:"lg",onClick:this.handleVisible,style:{marginBottom:"20px"},children:"Load more"}),this.state.images.length<=this.state.visible&&this.state.images.length>0&&Object(z.jsx)("p",{className:"mb-3",children:"No more images to load"})]})]})}}]),a}(n.Component),S=a(98),C=a(97),k=(a(87),function(){return Object(z.jsxs)(S.a,{bg:"dark",variant:"dark",className:"mb-3",children:[Object(z.jsx)(S.a.Brand,{href:"/home",children:"RGB Analyzer"}),Object(z.jsxs)(C.a,{className:"me-auto",children:[Object(z.jsx)(C.a.Link,{href:"/home",children:"Home"}),Object(z.jsx)(C.a.Link,{href:"/list",children:"Analysis History"})]}),Object(z.jsx)("div",{className:"license",children:Object(z.jsx)("p",{children:"\xa9 2023 jaycho@korea.ac.kr. All rights reserved."})})]})}),D=a(53),L=a(7);var T=function(){return Object(z.jsxs)(D.a,{children:[Object(z.jsx)(k,{}),Object(z.jsx)("div",{className:"App",children:Object(z.jsxs)(L.c,{children:[Object(z.jsx)(L.a,{exact:!0,path:"/main",component:w}),Object(z.jsx)(L.a,{exact:!0,path:"/list",component:N}),Object(z.jsx)(L.a,{exact:!0,path:"*",component:w})]})})]})},A=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,100)).then((function(t){var a=t.getCLS,n=t.getFID,s=t.getFCP,i=t.getLCP,c=t.getTTFB;a(e),n(e),s(e),i(e),c(e)}))};c.a.render(Object(z.jsx)(s.a.StrictMode,{children:Object(z.jsx)(T,{})}),document.getElementById("root")),A()}},[[91,1,2]]]);
//# sourceMappingURL=main.90373760.chunk.js.map